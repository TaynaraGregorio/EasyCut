<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>EasyCut - Barbearias Pr√≥ximas</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            margin: 0;
            font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            color: #fff;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow-x: hidden;
        }
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 20% 80%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(16, 185, 129, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }
        .container {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5),
                        0 0 0 1px rgba(255, 255, 255, 0.05);
            padding: 40px;
            max-width: 450px;
            width: 100%;
            position: relative;
            z-index: 1;
            margin: 20px;
        }
        .header {
            text-align: center;
            margin-bottom: 32px;
        }
        .logo {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #3b82f6 0%, #10b981 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 1px;
        }
        .subtitle {
            color: #94a3b8;
            font-size: 1rem;
            font-weight: 500;
        }
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: #94a3b8;
            text-decoration: none;
            font-size: 0.95rem;
            font-weight: 500;
            transition: all 0.3s ease;
            margin-bottom: 24px;
        }
        .back-link:hover {
            color: #3b82f6;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #e2e8f0;
            font-size: 0.95rem;
        }
        .search-container {
            position: relative;
        }
        input, select {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            background: rgba(30, 41, 59, 0.5);
            color: #fff;
            font-size: 1rem;
            transition: all 0.3s ease;
            box-sizing: border-box;
        }
        input:focus, select:focus {
            outline: none;
            border-color: #3b82f6;
            background: rgba(30, 41, 59, 0.8);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        input::placeholder {
            color: #64748b;
        }
        select {
            cursor: pointer;
        }
        select option {
            background: rgba(30, 41, 59, 0.95);
            color: #fff;
        }
        .search-icon {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: #64748b;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 8px;
            border-radius: 50%;
        }
        
        .search-icon:hover {
            color: #3b82f6;
            background: rgba(59, 130, 246, 0.1);
            transform: translateY(-50%) scale(1.1);
        }
        
        .search-icon:active {
            transform: translateY(-50%) scale(0.95);
        }
        .btn {
            width: 100%;
            padding: 16px 0;
            margin: 24px 0 16px 0;
            font-size: 1.1rem;
            font-weight: 600;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }
        .btn:hover::before {
            left: 100%;
        }
        .btn-primary {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: #fff;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }
        .btn-primary:hover {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }
        .btn-secondary {
            background: transparent;
            color: #94a3b8;
            border: 1px solid rgba(148, 163, 184, 0.3);
        }
        .btn-secondary:hover {
            background: rgba(148, 163, 184, 0.1);
            border-color: rgba(148, 163, 184, 0.5);
            color: #fff;
        }
        .suggestions {
            background: rgba(15, 23, 42, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            margin-top: 8px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            max-height: 200px;
            overflow-y: auto;
            display: none;
            backdrop-filter: blur(20px);
        }
        .suggestion-item {
            padding: 12px 16px;
            cursor: pointer;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            transition: background 0.2s ease;
            color: #e2e8f0;
        }
        .suggestion-item:hover {
            background: rgba(59, 130, 246, 0.1);
        }
        .suggestion-item:last-child {
            border-bottom: none;
        }
        .suggestion-item.selected {
            background: rgba(59, 130, 246, 0.2);
            color: #3b82f6;
        }
        .radius-info {
            text-align: center;
            margin: 16px 0;
            font-size: 0.9rem;
            color: #94a3b8;
            font-weight: 500;
        }
        .barbearias-list {
            margin-top: 24px;
        }
        .barbearia-card {
            background: rgba(30, 41, 59, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        .barbearia-card:hover {
            transform: translateY(-2px);
            background: rgba(30, 41, 59, 0.7);
            border-color: rgba(59, 130, 246, 0.3);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }
        .barbearia-header {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
        }
        .barbearia-image {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 16px;
            background: rgba(59, 130, 246, 0.2);
            border: 2px solid rgba(59, 130, 246, 0.3);
        }
        .barbearia-info h3 {
            font-size: 1.1rem;
            font-weight: 700;
            color: #fff;
            margin-bottom: 4px;
        }
        .barbearia-meta {
            font-size: 0.85rem;
            color: #94a3b8;
        }
        .barbearia-hours {
            font-size: 0.85rem;
            color: #94a3b8;
            margin-left: auto;
            text-align: right;
        }
        
        /* Indicador de Status */
        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            animation: pulse 2s infinite;
        }
        
        .status-indicator.open {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
            border: 1px solid rgba(16, 185, 129, 0.4);
        }
        
        .status-indicator.closed {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.4);
        }
        
        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            animation: blink 1.5s infinite;
        }
        
        .status-dot.open {
            background: #10b981;
        }
        
        .status-dot.closed {
            background: #ef4444;
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }
        
        @keyframes blink {
            0%, 50% {
                opacity: 1;
            }
            51%, 100% {
                opacity: 0.3;
            }
        }
        .services-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 12px;
        }
        .service-tag {
            background: rgba(59, 130, 246, 0.2);
            color: #60a5fa;
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 0.8rem;
            font-weight: 500;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }
        .loading {
            text-align: center;
            padding: 40px;
            color: #94a3b8;
        }
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 16px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .error-message {
            background: rgba(239, 68, 68, 0.1);
            color: #fca5a5;
            padding: 16px;
            border-radius: 12px;
            margin: 16px 0;
            text-align: center;
            font-size: 0.9rem;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        .success-message {
            background: rgba(16, 185, 129, 0.1);
            color: #6ee7b7;
            padding: 16px;
            border-radius: 12px;
            margin: 16px 0;
            text-align: center;
            font-size: 0.9rem;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }
        .menu-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 4px;
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .menu-toggle:hover {
            background: rgba(30, 41, 59, 1);
            border-color: rgba(59, 130, 246, 0.3);
            transform: scale(1.05);
        }
        
        .menu-line {
            width: 20px;
            height: 2px;
            background: #e2e8f0;
            border-radius: 1px;
            transition: all 0.3s ease;
        }
        
        .menu-toggle.active .menu-line:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }
        
        .menu-toggle.active .menu-line:nth-child(2) {
            opacity: 0;
        }
        
        .menu-toggle.active .menu-line:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -6px);
        }
        
        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .menu-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .menu-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 350px;
            height: 100%;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(20px);
            border-left: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 1000;
            transition: right 0.3s ease;
            overflow-y: auto;
        }
        
        .menu-panel.active {
            right: 0;
        }
        
        .menu-header {
            padding: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
        }
        
        .menu-user-info {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }
        
        .menu-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3b82f6 0%, #10b981 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 1.2rem;
        }
        
        .menu-user-details h3 {
            margin: 0;
            color: #e2e8f0;
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .menu-user-details p {
            margin: 4px 0 0 0;
            color: #94a3b8;
            font-size: 0.9rem;
        }
        
        .menu-content {
            padding: 20px;
        }
        
        .menu-section {
            margin-bottom: 24px;
        }
        
        .menu-section h4 {
            color: #e2e8f0;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .menu-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            margin-bottom: 8px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #e2e8f0;
            text-decoration: none;
        }
        
        .menu-item:hover {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
            transform: translateX(4px);
        }
        
        .menu-item-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
        }
        
        .menu-item-text {
            flex: 1;
            font-size: 0.95rem;
            font-weight: 500;
        }
        
        .menu-item-badge {
            background: rgba(239, 68, 68, 0.2);
            color: #fca5a5;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .menu-divider {
            height: 1px;
            background: rgba(255, 255, 255, 0.1);
            margin: 16px 0;
        }
        
        .menu-logout {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #fca5a5;
        }
        
        .menu-logout:hover {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }
        
        /* Responsividade do menu */
        @media (max-width: 480px) {
            .menu-panel {
                width: 100%;
                right: -100%;
            }
            
            .menu-toggle {
                top: 15px;
                right: 15px;
                width: 36px;
                height: 36px;
            }
            
            .menu-line {
                width: 18px;
            }
        }
        
        /* Filtros */
        .filters-section {
            margin: 24px 0;
            background: rgba(30, 41, 59, 0.3);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .filters-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .filters-header h3 {
            color: #e2e8f0;
            font-size: 1.1rem;
            font-weight: 600;
            margin: 0;
        }
        
        .btn-toggle {
            background: none;
            border: none;
            color: #94a3b8;
            font-size: 1.2rem;
            cursor: pointer;
            transition: color 0.3s ease;
        }
        
        .btn-toggle:hover {
            color: #3b82f6;
        }
        
        .filters-content {
            animation: slideDown 0.3s ease;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .filter-group {
            margin-bottom: 16px;
        }
        
        .filter-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #e2e8f0;
            font-size: 0.9rem;
        }
        
        .filter-group select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            background: rgba(30, 41, 59, 0.5);
            color: #fff;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        
        .filter-group select:focus {
            outline: none;
            border-color: #3b82f6;
            background: rgba(30, 41, 59, 0.8);
        }
        
        .filter-group select option {
            background: #1e293b;
            color: #fff;
        }
        
        .services-filter {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }
        
        .service-checkbox {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
        }
        
        .service-checkbox:hover {
            background: rgba(59, 130, 246, 0.2);
        }
        
        .service-checkbox input[type="checkbox"] {
            margin: 0;
        }
        
        .service-checkbox.checked {
            background: rgba(59, 130, 246, 0.3);
            border-color: #3b82f6;
        }
        
        .filter-group input[type="range"] {
            width: 100%;
            margin: 8px 0;
            -webkit-appearance: none;
            appearance: none;
            height: 6px;
            border-radius: 3px;
            background: rgba(255, 255, 255, 0.1);
            outline: none;
        }
        
        .filter-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            border: 2px solid #fff;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }
        
        .filter-group input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            border: 2px solid #fff;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }
        
        #distanceValue {
            color: #3b82f6;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .filter-group input[type="checkbox"] {
            margin-right: 8px;
            transform: scale(1.2);
        }
        
        .filter-actions {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }
        
        .filter-actions .btn {
            flex: 1;
            margin: 0;
            padding: 12px 0;
            font-size: 0.95rem;
        }
        
        /* Tablets e telas m√©dias */
        @media (max-width: 1024px) {
            .container {
                max-width: 400px;
                margin: 15px;
            }
        }
        
        /* Tablets pequenos */
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                padding: 28px;
                border-radius: 20px;
                max-width: 380px;
            }
            .logo {
                font-size: 1.9rem;
            }
            .subtitle {
                font-size: 0.95rem;
            }
            .btn {
                padding: 14px 0;
                font-size: 1.05rem;
            }
        }
        
        /* Smartphones grandes */
        @media (max-width: 600px) {
            .container {
                margin: 8px;
                padding: 24px;
                max-width: calc(100vw - 16px);
            }
            .logo {
                font-size: 1.7rem;
            }
            .form-group {
                margin-bottom: 18px;
            }
            input {
                padding: 12px 14px;
                font-size: 0.98rem;
            }
            .btn {
                padding: 14px 0;
                margin: 20px 0 14px 0;
            }
        }
        
        /* Smartphones m√©dios */
        @media (max-width: 480px) {
            .container {
                padding: 20px;
                margin: 5px;
                max-width: calc(100vw - 10px);
            }
            .logo {
                font-size: 1.6rem;
                margin-bottom: 6px;
            }
            .subtitle {
                font-size: 0.9rem;
            }
            .header {
                margin-bottom: 28px;
            }
            input {
                padding: 11px 13px;
                font-size: 0.95rem;
            }
            .btn {
                padding: 13px 0;
                font-size: 1rem;
                margin: 18px 0 12px 0;
            }
            .form-group {
                margin-bottom: 16px;
            }
            .back-link {
                font-size: 0.9rem;
                margin-bottom: 20px;
            }
            .info-text {
                font-size: 0.85rem;
            }
        }
        
        /* Smartphones pequenos */
        @media (max-width: 360px) {
            .container {
                padding: 16px;
                margin: 3px;
                max-width: calc(100vw - 6px);
            }
            .logo {
                font-size: 1.4rem;
            }
            .subtitle {
                font-size: 0.85rem;
            }
            input {
                padding: 10px 12px;
                font-size: 0.9rem;
            }
            .btn {
                padding: 12px 0;
                font-size: 0.95rem;
            }
            .form-group {
                margin-bottom: 14px;
            }
            .header {
                margin-bottom: 24px;
            }
        }
        
        /* Orienta√ß√£o landscape em smartphones */
        @media (max-height: 500px) and (orientation: landscape) {
            .container {
                margin: 5px;
                padding: 16px;
                max-height: calc(100vh - 10px);
                overflow-y: auto;
            }
            .header {
                margin-bottom: 16px;
            }
            .logo {
                font-size: 1.4rem;
                margin-bottom: 4px;
            }
            .subtitle {
                font-size: 0.8rem;
            }
            .form-group {
                margin-bottom: 12px;
            }
            .btn {
                padding: 10px 0;
                margin: 12px 0 8px 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Menu Hamb√∫rguer -->
        <div class="menu-toggle" id="menuToggle">
            <div class="menu-line"></div>
            <div class="menu-line"></div>
            <div class="menu-line"></div>
        </div>
        
        <button class="back-link" onclick="handleBackButton()" style="background: none; border: none; color: inherit; font: inherit; cursor: pointer; text-decoration: none;">
            ‚Üê Voltar
        </button>
        
        <div class="header">
            <div class="logo">EasyCut</div>
            <div class="subtitle">Barbearias Pr√≥ximas</div>
        </div>

        <!-- Se√ß√£o de Busca Unificada -->
        <div class="form-group">
            <label for="searchMode">Tipo de busca</label>
            <select id="searchMode" style="margin-bottom: 12px;">
                <option value="name">üîç Nome da barbearia</option>
                <option value="location">üìç Localiza√ß√£o/Endere√ßo</option>
            </select>
        </div>

        <div class="form-group">
            <label for="searchInput" id="searchLabel">Pesquisar por nome da barbearia</label>
            <div class="search-container">
                <input 
                    type="text" 
                    id="searchInput" 
                    placeholder="Ex: Barber King, Barbearia do Jo√£o..."
                    autocomplete="off"
                >
                <div class="search-icon" id="searchIcon">üîç</div>
                <div id="suggestions" class="suggestions"></div>
            </div>
            <div class="info-text" id="searchHint">Digite o nome da barbearia para buscar no banco de dados</div>
        </div>

        <button id="locationButton" class="btn btn-primary" style="display: none;">
            üìç Usar minha localiza√ß√£o
        </button>

        <div class="radius-info">
            Raio de <strong>5km</strong>
        </div>

        <!-- Filtros -->
        <div class="filters-section">
            <div class="filters-header">
                <h3>Filtros</h3>
                <button id="toggleFilters" class="btn-toggle">üîΩ</button>
            </div>
            <div id="filtersContent" class="filters-content" style="display: none;">
                <div class="filter-group">
                    <label>Avalia√ß√£o m√≠nima</label>
                    <select id="minRating">
                        <option value="">Qualquer</option>
                        <option value="4.5">4.5+ estrelas</option>
                        <option value="4.0">4.0+ estrelas</option>
                        <option value="3.5">3.5+ estrelas</option>
                        <option value="3.0">3.0+ estrelas</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label>Ordenar por</label>
                    <select id="priceSort">
                        <option value="">Sem ordena√ß√£o</option>
                        <option value="cheap">üí∞ Mais barato primeiro</option>
                        <option value="expensive">üíé Mais caro primeiro</option>
                        <option value="rating">‚≠ê Melhor avalia√ß√£o</option>
                        <option value="distance">üìç Mais pr√≥ximo</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label>Servi√ßos</label>
                    <div id="servicesFilter" class="services-filter">
                        <!-- Ser√° preenchido dinamicamente -->
                    </div>
                </div>
                
                <div class="filter-group">
                    <label>Dist√¢ncia m√°xima (km)</label>
                    <input type="range" id="maxDistance" min="1" max="20" value="5" step="1">
                    <span id="distanceValue">5 km</span>
                </div>
                
                <div class="filter-actions">
                    <button id="applyFilters" class="btn btn-primary">Aplicar Filtros</button>
                    <button id="clearFilters" class="btn btn-secondary">Limpar</button>
                </div>
            </div>
        </div>

        <!-- Lista de Barbearias -->
        <div class="barbearias-list" id="barbeariasList">
            <div class="loading">
                <div class="loading-spinner"></div>
                <div>Carregando barbearias pr√≥ximas...</div>
            </div>
        </div>
    </div>

    <!-- Menu Overlay -->
    <div class="menu-overlay" id="menuOverlay"></div>
    
    <!-- Menu Panel -->
    <div class="menu-panel" id="menuPanel">
        <div class="menu-header">
            <div class="menu-user-info">
                <div class="menu-avatar" id="userAvatar">U</div>
                <div class="menu-user-details">
                    <h3 id="userName">Usu√°rio</h3>
                    <p id="userType">Cliente</p>
                </div>
            </div>
        </div>
        
        <div class="menu-content" id="menuContent">
            <!-- Conte√∫do ser√° preenchido dinamicamente -->
        </div>
    </div>

    <script>
        class BarbeariasFinder {
            constructor() {
                this.searchInput = document.getElementById('searchInput');
                this.searchMode = document.getElementById('searchMode');
                this.searchLabel = document.getElementById('searchLabel');
                this.searchHint = document.getElementById('searchHint');
                this.locationButton = document.getElementById('locationButton');
                this.searchIcon = document.getElementById('searchIcon');
                this.suggestions = document.getElementById('suggestions');
                this.barbeariasList = document.getElementById('barbeariasList');
                this.currentLocation = null;
                this.selectedAddress = null;
                this.currentFilters = {};
                this.availableServices = [];
                this.searchTimeout = null;
                this.isLocationRequested = false;
                this.allBarbearias = []; // Armazenar todas as barbearias para filtragem
                this.searchModeValue = 'name'; // 'name' ou 'location'
                
                // Elementos do menu
                this.menuToggle = document.getElementById('menuToggle');
                this.menuOverlay = document.getElementById('menuOverlay');
                this.menuPanel = document.getElementById('menuPanel');
                this.menuContent = document.getElementById('menuContent');
                this.userAvatar = document.getElementById('userAvatar');
                this.userName = document.getElementById('userName');
                this.userType = document.getElementById('userType');
                this.isMenuOpen = false;
                
                // Elementos dos filtros
                this.toggleFilters = document.getElementById('toggleFilters');
                this.filtersContent = document.getElementById('filtersContent');
                this.minRating = document.getElementById('minRating');
                this.priceSort = document.getElementById('priceSort');
                this.servicesFilter = document.getElementById('servicesFilter');
                this.maxDistance = document.getElementById('maxDistance');
                this.distanceValue = document.getElementById('distanceValue');
                this.applyFilters = document.getElementById('applyFilters');
                this.clearFilters = document.getElementById('clearFilters');
                
                // ===== CONFIGURA√á√ïES DE API =====
                // Para usar Google Maps (mais preciso):
                // 1. Obtenha uma API Key em: https://console.cloud.google.com/
                // 2. Ative as APIs: Places API, Geocoding API, Maps JavaScript API
                // 3. Substitua 'SUA_API_KEY_AQUI' pela sua chave
                // 4. Mude useGoogleMaps para true
                this.googleApiKey = 'SUA_API_KEY_AQUI'; // Substitua pela sua API Key
                this.useGoogleMaps = false; // Mudar para true quando tiver API Key
                
                // Atualmente usando Nominatim (OpenStreetMap) - GRATUITO
                // N√£o requer API Key, mas pode ser menos preciso
                
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.updateSearchUI();
                // Mostrar mensagem inicial apropriada
                if (this.searchModeValue === 'name') {
                    this.barbeariasList.innerHTML = '<div class="info-text" style="text-align:center; padding: 40px;">Digite o nome da barbearia para buscar no banco de dados.</div>';
                } else {
                    this.barbeariasList.innerHTML = '<div class="info-text" style="text-align:center; padding: 40px;">Para come√ßar, use sua localiza√ß√£o ou digite um endere√ßo para encontrar barbearias pr√≥ximas.</div>';
                }
            }

            updateSearchUI() {
                if (this.searchModeValue === 'name') {
                    this.searchLabel.textContent = 'Pesquisar por nome da barbearia';
                    this.searchInput.placeholder = 'Ex: Barber King, Barbearia do Jo√£o...';
                    this.searchHint.textContent = 'Digite o nome da barbearia para buscar no banco de dados';
                    this.locationButton.style.display = 'none';
                } else {
                    this.searchLabel.textContent = 'Digite o endere√ßo';
                    this.searchInput.placeholder = 'Ex: Rua das Flores, 123, Centro, Ipatinga - MG';
                    this.searchHint.textContent = 'Digite pelo menos 3 caracteres para ver sugest√µes ‚Ä¢ Clique na lupa ou pressione Enter para buscar';
                    this.locationButton.style.display = 'block';
                }
            }

            setupEventListeners() {
                // Alternar modo de busca (Nome ou Localiza√ß√£o)
                this.searchMode.addEventListener('change', (e) => {
                    this.searchModeValue = e.target.value;
                    this.updateSearchUI();
                    this.searchInput.value = ''; // Limpar campo ao trocar modo
                    this.selectedAddress = null;
                    this.currentLocation = null;
                    this.allBarbearias = [];
                    this.hideSuggestions(); // Ocultar sugest√µes ao trocar modo
                    // Mostrar mensagem inicial apropriada
                    if (this.searchModeValue === 'name') {
                        this.barbeariasList.innerHTML = '<div class="info-text" style="text-align:center; padding: 40px;">Digite o nome da barbearia para buscar no banco de dados.</div>';
                    } else {
                        this.barbeariasList.innerHTML = '<div class="info-text" style="text-align:center; padding: 40px;">Para come√ßar, use sua localiza√ß√£o ou digite um endere√ßo para encontrar barbearias pr√≥ximas.</div>';
                    }
                });

                // Campo de busca unificado
                this.searchInput.addEventListener('input', (e) => {
                    if (this.searchModeValue === 'name') {
                        // Busca por nome: debounce e busca em tempo real
                        clearTimeout(this.searchTimeout);
                        this.searchTimeout = setTimeout(() => this.loadBarbearias(), 500);
                    } else {
                        // Busca por localiza√ß√£o: mostrar sugest√µes
                        this.handleAddressInputWithDebounce(e.target.value);
                    }
                });

                // Busca ao pressionar Enter
                this.searchInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        if (this.searchModeValue === 'location') {
                            this.performSearch();
                        } else {
                            this.loadBarbearias();
                        }
                    }
                });

                // √çcone da lupa clic√°vel
                this.searchIcon.addEventListener('click', () => {
                    if (this.searchModeValue === 'location') {
                        this.performSearch();
                    } else {
                        this.loadBarbearias();
                    }
                });

                // Sele√ß√£o de sugest√£o
                this.suggestions.addEventListener('click', (e) => {
                    if (e.target.classList.contains('suggestion-item')) {
                        this.selectSuggestion(e.target.textContent);
                    }
                });

                // Bot√£o de localiza√ß√£o
                this.locationButton.addEventListener('click', () => {
                    this.getCurrentLocation();
                });

                // Fechar sugest√µes ao clicar fora
                document.addEventListener('click', (e) => {
                    if (!e.target.closest('.search-container')) {
                        this.hideSuggestions();
                    }
                });

                // Filtros
                this.toggleFilters.addEventListener('click', () => {
                    this.toggleFiltersPanel();
                });

                this.maxDistance.addEventListener('input', (e) => {
                    this.distanceValue.textContent = `${e.target.value} km`;
                });

                this.applyFilters.addEventListener('click', () => {
                    this.applyCurrentFilters();
                });

                this.clearFilters.addEventListener('click', () => {
                    this.clearAllFilters();
                });

                // Carregar servi√ßos dispon√≠veis
                this.loadAvailableServices();
                
                // Event listeners do menu
                this.setupMenuEventListeners();
                
                // Detectar tipo de usu√°rio e configurar menu
                this.detectUserType();
            }

            // ===== M√âTODOS DO MENU =====
            
            setupMenuEventListeners() {
                // Toggle do menu
                this.menuToggle.addEventListener('click', () => {
                    this.toggleMenu();
                });
                
                // Fechar menu ao clicar no overlay
                this.menuOverlay.addEventListener('click', () => {
                    this.closeMenu();
                });
                
                // Fechar menu com ESC
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && this.isMenuOpen) {
                        this.closeMenu();
                    }
                });
            }
            
            toggleMenu() {
                if (this.isMenuOpen) {
                    this.closeMenu();
                } else {
                    this.openMenu();
                }
            }
            
            openMenu() {
                this.isMenuOpen = true;
                this.menuToggle.classList.add('active');
                this.menuOverlay.classList.add('active');
                this.menuPanel.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
            
            closeMenu() {
                this.isMenuOpen = false;
                this.menuToggle.classList.remove('active');
                this.menuOverlay.classList.remove('active');
                this.menuPanel.classList.remove('active');
                document.body.style.overflow = '';
            }
            
            detectUserType() {
                // Detectar tipo de usu√°rio baseado nos dados salvos
                const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
                const userType = currentUser.tipo || 'cliente';
                const userName = currentUser.nomeCompleto || currentUser.nomeBarbearia || 'Usu√°rio';
                
                this.userType.textContent = userType === 'barbearia' ? 'Barbearia' : 'Cliente';
                this.userName.textContent = userName;
                this.userAvatar.textContent = userName.charAt(0).toUpperCase();
                
                this.renderMenuContent(userType);
            }
            
            renderMenuContent(userType) {
                if (userType === 'barbearia') {
                    this.renderBarbeariaMenu();
                } else {
                    this.renderClienteMenu();
                }
            }
            
            renderClienteMenu() {
                this.menuContent.innerHTML = `
                    <div class="menu-section">
                        <h4>Meu Perfil</h4>
                        <div class="menu-item" onclick="barbeariasFinder.handleMenuClick('editProfile')">
                            <div class="menu-item-icon">üë§</div>
                            <div class="menu-item-text">Editar Perfil</div>
                        </div>
                        
                    </div>
                    
                    <div class="menu-section">
                        <h4>Agendamentos</h4>
                        <div class="menu-item" onclick="barbeariasFinder.handleMenuClick('myAppointments')">
                            <div class="menu-item-icon">üìÖ</div>
                            <div class="menu-item-text">Meus Agendamentos</div>
                            <div class="menu-item-badge">3</div>
                        </div>
                    </div>
                    
                    <div class="menu-section">
                        <h4>Favoritos</h4>
                        <div class="menu-item" onclick="barbeariasFinder.handleMenuClick('favorites')">
                            <div class="menu-item-icon">‚ù§Ô∏è</div>
                            <div class="menu-item-text">Barbearias Favoritas</div>
                        </div>
                    </div>
                    
                    <div class="menu-divider"></div>
                    
                    <div class="menu-section">
                        <div class="menu-item menu-logout" onclick="barbeariasFinder.handleMenuClick('logout')">
                            <div class="menu-item-icon">üö™</div>
                            <div class="menu-item-text">Sair</div>
                        </div>
                    </div>
                `;
            }
            
            renderBarbeariaMenu() {
                this.menuContent.innerHTML = `
                    <div class="menu-section">
                        <h4>Gerenciar Barbearia</h4>
                        <div class="menu-item" onclick="barbeariasFinder.handleMenuClick('editProfile')">
                            <div class="menu-item-icon">üè™</div>
                            <div class="menu-item-text">Editar Perfil</div>
                        </div>
                        <div class="menu-item" onclick="barbeariasFinder.handleMenuClick('manageServices')">
                            <div class="menu-item-icon">‚úÇÔ∏è</div>
                            <div class="menu-item-text">Gerenciar Servi√ßos</div>
                        </div>
                        <div class="menu-item" onclick="barbeariasFinder.handleMenuClick('manageLocation')">
                            <div class="menu-item-icon">üìç</div>
                            <div class="menu-item-text">Localiza√ß√£o</div>
                        </div>
                        <div class="menu-item" onclick="barbeariasFinder.handleMenuClick('manageContacts')">
                            <div class="menu-item-icon">üìû</div>
                            <div class="menu-item-text">Contatos</div>
                        </div>
                    </div>
                    
                    <div class="menu-section">
                        <h4>Agendamentos</h4>
                        <div class="menu-item" onclick="barbeariasFinder.handleMenuClick('appointments')">
                            <div class="menu-item-icon">üìÖ</div>
                            <div class="menu-item-text">Agendamentos</div>
                            <div class="menu-item-badge">12</div>
                        </div>
                        <div class="menu-item" onclick="barbeariasFinder.handleMenuClick('schedule')">
                            <div class="menu-item-icon">‚è∞</div>
                            <div class="menu-item-text">Hor√°rios</div>
                        </div>
                    </div>
                    
                    <div class="menu-section">
                        <h4>Relat√≥rios</h4>
                        <div class="menu-item" onclick="barbeariasFinder.handleMenuClick('reports')">
                            <div class="menu-item-icon">üìä</div>
                            <div class="menu-item-text">Relat√≥rios</div>
                        </div>
                        <div class="menu-item" onclick="barbeariasFinder.handleMenuClick('reviews')">
                            <div class="menu-item-icon">‚≠ê</div>
                            <div class="menu-item-text">Avalia√ß√µes</div>
                        </div>
                    </div>
                    
                    <div class="menu-divider"></div>
                    
                    <div class="menu-section">
                        <div class="menu-item menu-logout" onclick="barbeariasFinder.handleMenuClick('logout')">
                            <div class="menu-item-icon">üö™</div>
                            <div class="menu-item-text">Sair</div>
                        </div>
                    </div>
                `;
            }
            
            handleMenuClick(action) {
                this.closeMenu();
                
                switch (action) {
                    case 'editProfile':
                        this.handleEditProfile();
                        break;
                    case 'changePassword':
                        this.showComingSoon('Alterar Senha');
                        break;
                    case 'myAppointments':
                        window.location.href = 'MeusAgendamentos.html';
                        break;
                    case 'favorites':
                        window.location.href = 'Favoritos.html';
                        break;
                    case 'manageServices':
                        this.showComingSoon('Gerenciar Servi√ßos');
                        break;
                    case 'manageLocation':
                        this.showComingSoon('Gerenciar Localiza√ß√£o');
                        break;
                    case 'manageContacts':
                        this.showComingSoon('Gerenciar Contatos');
                        break;
                    case 'appointments':
                        this.showComingSoon('Agendamentos');
                        break;
                    case 'schedule':
                        this.showComingSoon('Gerenciar Hor√°rios');
                        break;
                    case 'reports':
                        this.showComingSoon('Relat√≥rios');
                        break;
                    case 'reviews':
                        this.showComingSoon('Avalia√ß√µes');
                        break;
                    case 'logout':
                        this.handleLogout();
                        break;
                    default:
                        console.log('A√ß√£o n√£o implementada:', action);
                }
            }
            
            handleEditProfile() {
                const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
                const userType = currentUser.tipo || 'cliente';
                
                if (userType === 'barbearia') {
                    window.location.href = 'EditarPerfilBarbearia.html';
                } else {
                    window.location.href = 'EditarPerfilCliente.html';
                }
            }
            
            showComingSoon(feature) {
                alert(`üöß ${feature} - Em breve!\n\nEsta funcionalidade est√° sendo desenvolvida e estar√° dispon√≠vel em breve.`);
            }
            
            handleLogout() {
                if (confirm('Tem certeza que deseja sair?')) {
                    // Limpar dados do usu√°rio
                    localStorage.removeItem('currentUser');
                    localStorage.removeItem('userType');
                    localStorage.removeItem('userName');
                    localStorage.removeItem('userToken');
                    
                    // Redirecionar para tela inicial
                    window.location.href = 'Login.html';
                }
            }

            // M√©todo com debounce para otimizar chamadas de API
            handleAddressInputWithDebounce(value) {
                clearTimeout(this.searchTimeout);
                
                if (value.length < 3) {
                    this.hideSuggestions();
                    return;
                }

                this.searchTimeout = setTimeout(() => {
                    this.handleAddressInput(value);
                }, 300); // Aguarda 300ms ap√≥s parar de digitar
            }

            async handleAddressInput(value) {
                try {
                    let suggestions = [];
                    
                    if (this.useGoogleMaps) {
                        suggestions = await this.getGooglePlacesSuggestions(value);
                    } else {
                        suggestions = await this.getNominatimSuggestions(value);
                    }
                    
                    this.showSuggestions(suggestions);
                } catch (error) {
                    console.error('Erro ao buscar sugest√µes:', error);
                    // Fallback para sugest√µes mock
                    const mockSuggestions = await this.getMockSuggestions(value);
                    this.showSuggestions(mockSuggestions);
                }
            }

            // M√©todo para realizar busca manual (lupa ou Enter) - apenas para modo LOCALIZA√á√ÉO
            async performSearch() {
                if (this.searchModeValue !== 'location') {
                    return; // S√≥ funciona no modo localiza√ß√£o
                }
                
                const address = this.searchInput.value.trim();
                
                if (!address) {
                    this.showError('Por favor, digite um endere√ßo para buscar.');
                    return;
                }

                if (address.length < 3) {
                    this.showError('Digite pelo menos 3 caracteres para buscar.');
                    return;
                }

                this.hideSuggestions();
                this.showLoading();

                try {
                    // Tentar geocodificar o endere√ßo digitado
                    const coordinates = await this.geocode(address);
                    this.currentLocation = coordinates;
                    this.selectedAddress = address;
                    
                    await this.loadBarbearias();
                    this.showSuccess('Endere√ßo encontrado! Carregando barbearias pr√≥ximas...');
                } catch (error) {
                    console.error('Erro ao buscar endere√ßo:', error);
                    this.showError('N√£o foi poss√≠vel encontrar este endere√ßo. Tente novamente.');
                }
            }

            // ===== M√âTODOS DE SUGEST√ïES DE ENDERE√áO =====
            
            async getGooglePlacesSuggestions(query) {
                // Google Places Autocomplete API com foco no Vale do A√ßo - MG
                const url = `https://maps.googleapis.com/maps/api/place/autocomplete/json?input=${encodeURIComponent(query)}&key=${this.googleApiKey}&language=pt-BR&components=country:br&types=address&location=-19.4703,-42.5369&radius=50000`;
                
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.status === 'OK') {
                    // Filtrar resultados do Vale do A√ßo
                    const valeDoAcoResults = data.predictions.filter(prediction => {
                        const description = prediction.description.toLowerCase();
                        return description.includes('ipatinga') || 
                               description.includes('tim√≥teo') || 
                               description.includes('coronel fabriciano') ||
                               description.includes('santana do para√≠so') ||
                               description.includes('minas gerais');
                    });
                    
                    return valeDoAcoResults.map(prediction => prediction.description);
                } else {
                    throw new Error(`Google Places API error: ${data.status}`);
                }
            }
            
            async getNominatimSuggestions(query) {
                // OpenStreetMap Nominatim API (gratuita) - Focada no Vale do A√ßo - MG com m√°xima precis√£o
                const valeDoAcoQuery = `${query}, Vale do A√ßo, Minas Gerais, Brasil`;
                const url = `https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(valeDoAcoQuery)}&format=json&limit=10&addressdetails=1&countrycodes=br&bounded=1&viewbox=-42.8,-19.6,-42.2,-19.2&extratags=1`;
                
                const response = await fetch(url, {
                    headers: {
                        'User-Agent': 'EasyCut/1.0'
                    }
                });
                const data = await response.json();
                
                // Filtrar e formatar resultados do Vale do A√ßo com endere√ßos precisos
                const valeDoAcoResults = data.filter(result => {
                    const displayName = result.display_name.toLowerCase();
                    return displayName.includes('ipatinga') || 
                           displayName.includes('tim√≥teo') || 
                           displayName.includes('coronel fabriciano') ||
                           displayName.includes('santana do para√≠so') ||
                           displayName.includes('vale do a√ßo') ||
                           displayName.includes('minas gerais');
                });
                
                // Formatar endere√ßos com componentes espec√≠ficos
                return valeDoAcoResults.map(result => {
                    if (result.address) {
                        const address = result.address;
                        let enderecoFormatado = '';
                        
                        // Montar endere√ßo com componentes espec√≠ficos
                        if (address.road || address.pedestrian || address.footway) {
                            const rua = address.road || address.pedestrian || address.footway;
                            const numero = address.house_number || '';
                            enderecoFormatado += `${rua}${numero ? ', ' + numero : ''}`;
                        }
                        
                        if (address.suburb || address.neighbourhood || address.quarter) {
                            const bairro = address.suburb || address.neighbourhood || address.quarter;
                            enderecoFormatado += enderecoFormatado ? `, ${bairro}` : bairro;
                        }
                        
                        if (address.city || address.town || address.village) {
                            const cidade = address.city || address.town || address.village;
                            enderecoFormatado += enderecoFormatado ? `, ${cidade}` : cidade;
                        }
                        
                        if (address.state) {
                            enderecoFormatado += enderecoFormatado ? ` - ${address.state}` : address.state;
                        }
                        
                        return enderecoFormatado || result.display_name;
                    }
                    return result.display_name;
                });
            }
            
            async getMockSuggestions(query) {
                // Fallback com sugest√µes mock - Focadas no Vale do A√ßo - MG com endere√ßos precisos
                const mockSuggestions = [
                    `${query}, 123, Centro, Ipatinga - MG`,
                    `${query}, 456, Cariru, Ipatinga - MG`,
                    `${query}, 789, Cidade Nova, Ipatinga - MG`,
                    `${query}, 321, Veneza, Ipatinga - MG`,
                    `${query}, 654, Beth√¢nia, Ipatinga - MG`,
                    `${query}, 987, Centro, Tim√≥teo - MG`,
                    `${query}, 147, Centro, Coronel Fabriciano - MG`,
                    `${query}, 258, Centro, Santana do Para√≠so - MG`
                ];

                await new Promise(resolve => setTimeout(resolve, 300));
                
                return mockSuggestions.filter(suggestion => 
                    suggestion.toLowerCase().includes(query.toLowerCase())
                );
            }

            showSuggestions(suggestions) {
                if (suggestions.length === 0) {
                    this.hideSuggestions();
                    return;
                }

                this.suggestions.innerHTML = suggestions.map(suggestion => 
                    `<div class="suggestion-item">${suggestion}</div>`
                ).join('');

                this.suggestions.style.display = 'block';
            }

            hideSuggestions() {
                this.suggestions.style.display = 'none';
            }

            async selectSuggestion(address) {
                this.searchInput.value = address;
                this.selectedAddress = address;
                this.hideSuggestions();

                try {
                    // Converter endere√ßo para coordenadas (Geocodifica√ß√£o)
                    const coordinates = await this.geocode(address);
                    this.currentLocation = coordinates;
                    
                    await this.loadBarbearias();
                } catch (error) {
                    console.error('Erro ao converter endere√ßo:', error);
                    // Usar localiza√ß√£o do Vale do A√ßo se falhar
                    this.currentLocation = { lat: -19.4703, lng: -42.5369 }; // Centro de Ipatinga-MG
                    await this.loadBarbearias();
                }
            }
            
            async geocode(address) {
                try {
                    let coordinates = null;
                    
                    if (this.useGoogleMaps) {
                        coordinates = await this.googleGeocode(address);
                    } else {
                        coordinates = await this.nominatimGeocode(address);
                    }
                    
                    return coordinates;
                } catch (error) {
                    console.error('Erro na geocodifica√ß√£o:', error);
                    throw error;
                }
            }
            
            async googleGeocode(address) {
                const url = `https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(address)}&key=${this.googleApiKey}`;
                
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.status === 'OK' && data.results.length > 0) {
                    const location = data.results[0].geometry.location;
                    return { lat: location.lat, lng: location.lng };
                } else {
                    throw new Error(`Google Geocoding API error: ${data.status}`);
                }
            }
            
            async nominatimGeocode(address) {
                // Geocodifica√ß√£o focada no Vale do A√ßo - MG
                const valeDoAcoAddress = `${address}, Vale do A√ßo, Minas Gerais, Brasil`;
                const url = `https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(valeDoAcoAddress)}&format=json&limit=1&addressdetails=1&countrycodes=br&bounded=1&viewbox=-42.8,-19.6,-42.2,-19.2`;
                
                const response = await fetch(url, {
                    headers: {
                        'User-Agent': 'EasyCut/1.0'
                    }
                });
                const data = await response.json();
                
                if (data && data.length > 0) {
                    return { lat: parseFloat(data[0].lat), lng: parseFloat(data[0].lon) };
                } else {
                    throw new Error('Nominatim geocoding failed');
                }
            }

            async getCurrentLocation() {
                // Evitar m√∫ltiplas requisi√ß√µes simult√¢neas
                if (this.isLocationRequested) {
                    return;
                }

                this.isLocationRequested = true;
                this.locationButton.disabled = true;
                this.locationButton.textContent = 'üìç Obtendo localiza√ß√£o...';

                if (!navigator.geolocation) {
                    this.showError('Geolocaliza√ß√£o n√£o √© suportada neste navegador.');
                    this.resetLocationButton();
                    return;
                }

                try {
                    // Verificar permiss√µes primeiro
                    const permission = await this.checkLocationPermission();
                    if (permission === 'denied') {
                        this.showError('Permiss√£o de localiza√ß√£o negada. Por favor, permita o acesso √† localiza√ß√£o nas configura√ß√µes do navegador.');
                        this.resetLocationButton();
                        return;
                    }

                    if (permission === 'prompt') {
                        this.locationButton.textContent = 'üìç Aguardando permiss√£o...';
                    }

                    const position = await this.getCurrentPositionPromise();
                    this.currentLocation = {
                        lat: position.coords.latitude,
                        lng: position.coords.longitude
                    };

                    // Verificar se a localiza√ß√£o est√° no Vale do A√ßo
                    const isInValeDoAco = this.isLocationInValeDoAco(this.currentLocation);
                    if (!isInValeDoAco) {
                        this.showError('Sua localiza√ß√£o est√° fora da regi√£o do Vale do A√ßo. Por favor, digite um endere√ßo da regi√£o.');
                        this.resetLocationButton();
                        return;
                    }

                    // Converter coordenadas para endere√ßo
                    const address = await this.reverseGeocode(this.currentLocation);
                    if (this.searchModeValue === 'location') {
                        this.searchInput.value = address;
                    }
                    this.selectedAddress = address;

                    this.showSuccess('Localiza√ß√£o obtida com sucesso!');
                    await this.loadBarbearias();

                } catch (error) {
                    console.error('Erro ao obter localiza√ß√£o:', error);
                    this.handleLocationError(error);
                } finally {
                    this.resetLocationButton();
                }
            }

            // Verificar permiss√µes de localiza√ß√£o
            async checkLocationPermission() {
                if (!navigator.permissions) {
                    return 'unknown';
                }

                try {
                    const permission = await navigator.permissions.query({ name: 'geolocation' });
                    return permission.state;
                } catch (error) {
                    return 'unknown';
                }
            }

            // Verificar se a localiza√ß√£o est√° no Vale do A√ßo
            isLocationInValeDoAco(location) {
                const valeDoAcoBounds = {
                    north: -19.2,
                    south: -19.6,
                    east: -42.2,
                    west: -42.8
                };

                return location.lat >= valeDoAcoBounds.south && 
                       location.lat <= valeDoAcoBounds.north &&
                       location.lng >= valeDoAcoBounds.west && 
                       location.lng <= valeDoAcoBounds.east;
            }

            // Tratar erros de geolocaliza√ß√£o de forma mais espec√≠fica
            handleLocationError(error) {
                switch (error.code) {
                    case error.PERMISSION_DENIED:
                        this.showError('Permiss√£o de localiza√ß√£o negada. Por favor, permita o acesso nas configura√ß√µes do navegador.');
                        break;
                    case error.POSITION_UNAVAILABLE:
                        this.showError('Localiza√ß√£o indispon√≠vel. Verifique se o GPS est√° ativado.');
                        break;
                    case error.TIMEOUT:
                        this.showError('Tempo limite excedido. Tente novamente.');
                        break;
                    default:
                        this.showError('N√£o foi poss√≠vel obter sua localiza√ß√£o. Tente digitar um endere√ßo.');
                        break;
                }
            }

            getCurrentPositionPromise() {
                return new Promise((resolve, reject) => {
                    navigator.geolocation.getCurrentPosition(resolve, reject, {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 300000
                    });
                });
            }

            async reverseGeocode(location) {
                try {
                    let address = '';
                    
                    if (this.useGoogleMaps) {
                        address = await this.googleReverseGeocode(location.lat, location.lng);
                    } else {
                        address = await this.nominatimReverseGeocode(location.lat, location.lng);
                    }
                    
                    return address;
                } catch (error) {
                    console.error('Erro na geocodifica√ß√£o reversa:', error);
                    // Fallback para endere√ßo do Vale do A√ßo
                    return `üìç Localiza√ß√£o atual (${location.lat.toFixed(4)}, ${location.lng.toFixed(4)})`;
                }
            }
            
            async googleReverseGeocode(lat, lng) {
                // Google Geocoding com m√°xima precis√£o para o Vale do A√ßo
                const url = `https://maps.googleapis.com/maps/api/geocode/json?latlng=${lat},${lng}&key=${this.googleApiKey}&language=pt-BR&result_type=street_address|route|premise|subpremise`;
                
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.status === 'OK' && data.results.length > 0) {
                    // Procurar resultado mais espec√≠fico (rua + n√∫mero)
                    const specificResult = data.results.find(result => 
                        result.types.includes('street_address') || 
                        result.types.includes('premise')
                    );
                    
                    if (specificResult) {
                        return specificResult.formatted_address;
                    } else {
                        return data.results[0].formatted_address;
                    }
                } else {
                    throw new Error(`Google Geocoding API error: ${data.status}`);
                }
            }
            
            async nominatimReverseGeocode(lat, lng) {
                // Geocodifica√ß√£o reversa focada no Vale do A√ßo - MG com m√°xima precis√£o
                const url = `https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lng}&format=json&addressdetails=1&accept-language=pt-BR&zoom=18&extratags=1`;
                
                const response = await fetch(url, {
                    headers: {
                        'User-Agent': 'EasyCut/1.0'
                    }
                });
                const data = await response.json();
                
                if (data && data.address) {
                    // Construir endere√ßo completo e preciso
                    const address = data.address;
                    let enderecoCompleto = '';
                    
                    // Montar endere√ßo com componentes espec√≠ficos
                    if (address.road || address.pedestrian || address.footway) {
                        const rua = address.road || address.pedestrian || address.footway;
                        const numero = address.house_number || '';
                        enderecoCompleto += `${rua}${numero ? ', ' + numero : ''}`;
                    }
                    
                    if (address.suburb || address.neighbourhood || address.quarter) {
                        const bairro = address.suburb || address.neighbourhood || address.quarter;
                        enderecoCompleto += enderecoCompleto ? `, ${bairro}` : bairro;
                    }
                    
                    if (address.city || address.town || address.village) {
                        const cidade = address.city || address.town || address.village;
                        enderecoCompleto += enderecoCompleto ? `, ${cidade}` : cidade;
                    }
                    
                    if (address.state) {
                        enderecoCompleto += enderecoCompleto ? ` - ${address.state}` : address.state;
                    }
                    
                    // Verificar se est√° no Vale do A√ßo
                    const enderecoLower = enderecoCompleto.toLowerCase();
                    if (enderecoLower.includes('ipatinga') || 
                        enderecoLower.includes('tim√≥teo') || 
                        enderecoLower.includes('coronel fabriciano') ||
                        enderecoLower.includes('santana do para√≠so') ||
                        enderecoLower.includes('vale do a√ßo') ||
                        enderecoLower.includes('minas gerais')) {
                        return enderecoCompleto;
                    } else {
                        // Se n√£o estiver no Vale do A√ßo, usar coordenadas
                        return `üìç Localiza√ß√£o atual (${lat.toFixed(4)}, ${lng.toFixed(4)})`;
                    }
                } else {
                    throw new Error('Nominatim reverse geocoding failed');
                }
            }

            resetLocationButton() {
                this.isLocationRequested = false;
                this.locationButton.disabled = false;
                this.locationButton.textContent = 'üìç Usar minha localiza√ß√£o';
            }

            async loadBarbearias() {
                const searchQuery = this.searchInput.value.trim();
                const isNameMode = this.searchModeValue === 'name';
                
                console.log('[DEBUG] loadBarbearias chamado:', { 
                    isNameMode, 
                    searchQuery, 
                    searchQueryLength: searchQuery.length,
                    hasLocation: !!this.currentLocation,
                    selectedAddress: this.selectedAddress 
                });
                
                try {
                    if (isNameMode && searchQuery) {
                        // Modo NOME: busca por nome no banco
                        console.log('[DEBUG] Modo NOME com query v√°lida. Chamando loadRealBarbearias...');
                        await this.loadRealBarbearias();
                    } else if (!isNameMode && (this.currentLocation || this.selectedAddress)) {
                        // Modo LOCALIZA√á√ÉO: busca por localiza√ß√£o
                        console.log('[DEBUG] Modo LOCALIZA√á√ÉO com coordenadas. Chamando loadRealBarbearias...');
                        await this.loadRealBarbearias();
                    } else {
                        // Nenhuma busca realizada ainda
                        console.log('[DEBUG] Nenhuma busca v√°lida. Mostrando mensagem inicial.');
                        if (isNameMode) {
                            this.barbeariasList.innerHTML = `<div class="info-text" style="text-align:center; padding: 40px;">Digite o nome da barbearia para buscar no banco de dados.</div>`;
                        } else {
                            this.barbeariasList.innerHTML = `<div class="info-text" style="text-align:center; padding: 40px;">Para come√ßar, use sua localiza√ß√£o ou digite um endere√ßo para encontrar barbearias pr√≥ximas.</div>`;
                        }
                        this.allBarbearias = [];
                    }
                    // N√ÉO aplicar filtros ap√≥s carregar - os dados j√° v√™m filtrados da API
                    // Apenas atualizar allBarbearias para que os filtros avan√ßados funcionem se necess√°rio
                    // this.applyCurrentFilters(); // Comentado - estava removendo resultados da busca por nome
                } catch (error) {
                    console.error('Erro ao carregar barbearias:', error);
                    this.showError('Erro ao carregar barbearias. Tente novamente.');
                }
            }

            async loadRealBarbearias() {
                this.showLoading();
                const searchQuery = this.searchInput.value.trim();
                const isNameMode = this.searchModeValue === 'name';
                const hasLocation = !!this.currentLocation;
                
                console.log('[DEBUG] Carregando barbearias:', { 
                    mode: isNameMode ? 'NOME' : 'LOCALIZA√á√ÉO',
                    query: searchQuery, 
                    hasLocation, 
                    location: this.currentLocation 
                });
                
                const requestBody = {
                    radius: parseFloat(this.maxDistance.value) || 5.0
                };

                if (isNameMode && searchQuery) {
                    // Modo NOME: enviar nome para busca
                    requestBody.name = searchQuery;
                } else if (!isNameMode && this.currentLocation) {
                    // Modo LOCALIZA√á√ÉO: enviar coordenadas
                    requestBody.latitude = this.currentLocation.lat;
                    requestBody.longitude = this.currentLocation.lng;
                } else if (!isNameMode && this.selectedAddress) {
                    // Modo LOCALIZA√á√ÉO com endere√ßo selecionado: j√° tem currentLocation definido pelo selectSuggestion
                    if (this.currentLocation) {
                        requestBody.latitude = this.currentLocation.lat;
                        requestBody.longitude = this.currentLocation.lng;
                    }
                }
                
                console.log('[DEBUG] Request body:', requestBody);
                console.log('[DEBUG] JSON stringificado:', JSON.stringify(requestBody));

                try {
                    const response = await fetch('http://localhost:5001/api/barbearias/nearby', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(requestBody)
                    });
                    
                    console.log('[DEBUG] Response status:', response.status);
                    console.log('[DEBUG] Response ok:', response.ok);

                    if (!response.ok) {
                        const errorData = await response.json().catch(() => ({ message: response.statusText }));
                        throw new Error(errorData.message || `Erro na API: ${response.status}`);
                    }

                    const data = await response.json();
                    console.log('[DEBUG] Resposta da API:', { success: data.success, count: data.barbearias?.length, message: data.message });
                    console.log('[DEBUG] Conte√∫do completo da resposta:', data);
                    if (data.barbearias && data.barbearias.length > 0) {
                        console.log('[DEBUG] Primeira barbearia retornada:', data.barbearias[0]);
                    }

                    if (data.success) {
                        if (data.barbearias && data.barbearias.length > 0) {
                            console.log('[DEBUG] Exibindo', data.barbearias.length, 'barbearias');
                            console.log('[DEBUG] Nomes das barbearias:', data.barbearias.map(b => b.name));
                            this.displayBarbearias(data.barbearias);
                        } else {
                            const searchQuery = this.searchInput.value.trim();
                            const isNameMode = this.searchModeValue === 'name';
                            const locationMsg = this.currentLocation ? ' nesta localiza√ß√£o' : '';
                            console.log('[DEBUG] Nenhuma barbearia encontrada');
                            
                            let message = '';
                            if (isNameMode && searchQuery) {
                                message = `
                                    <p>Nenhuma barbearia com o nome "<strong>${searchQuery}</strong>" foi encontrada no banco de dados.</p>
                                    <p>Tente buscar por outro nome ou altere o modo de busca para "Localiza√ß√£o/Endere√ßo".</p>
                                `;
                            } else {
                                message = `
                                    <p>Nenhuma barbearia encontrada${locationMsg}.</p>
                                    <p>Tente usar outro endere√ßo, alterar o modo de busca para "Nome da barbearia" ou usar o bot√£o "Usar minha localiza√ß√£o".</p>
                                `;
                            }
                            
                            this.barbeariasList.innerHTML = `
                                <div class="info-text" style="text-align:center; padding: 40px;">
                                    ${message}
                                </div>
                            `;
                            this.allBarbearias = [];
                            this.showResultsCount(0, 0);
                        }
                    } else {
                        console.error('[DEBUG] Erro na API:', data.message);
                        this.showError(data.message || 'N√£o foi poss√≠vel carregar as barbearias.');
                    }
                } catch (error) {
                    console.error('Erro ao carregar barbearias reais:', error);
                    this.showError('Falha ao conectar com o servidor. Verifique se a API est√° rodando e tente novamente.');
                }
            }

            async loadAvailableServices() {
                // Usar servi√ßos mock diretamente (sem tentar conectar com API)
                console.log('Carregando servi√ßos mock...');
                this.availableServices = [
                    "Corte masculino", "Barba", "Sobrancelha", "Design de sobrancelhas", 
                    "Barboterapia", "Massagem facial", "Tratamentos capilares", 
                    "Progressivas", "Relaxamento", "Pigmenta√ß√£o", "Limpeza de pele", 
                    "Toalha quente", "Massagem", "Tratamentos"
                ];
                this.renderServicesFilter();
            }

            renderServicesFilter() {
                this.servicesFilter.innerHTML = this.availableServices.map(service => `
                    <div class="service-checkbox" onclick="this.toggleService(this)">
                        <input type="checkbox" id="service_${service.replace(/\s+/g, '_')}" value="${service}">
                        <label for="service_${service.replace(/\s+/g, '_')}">${service}</label>
                    </div>
                `).join('');
            }

            toggleService(element) {
                const checkbox = element.querySelector('input[type="checkbox"]');
                checkbox.checked = !checkbox.checked;
                
                if (checkbox.checked) {
                    element.classList.add('checked');
                } else {
                    element.classList.remove('checked');
                }
            }

            toggleFiltersPanel() {
                const isVisible = this.filtersContent.style.display !== 'none';
                this.filtersContent.style.display = isVisible ? 'none' : 'block';
                this.toggleFilters.textContent = isVisible ? 'üîΩ' : 'üîº';
            }

            applyCurrentFilters() {
                // S√≥ aplicar filtro por nome se estiver no modo NOME e tiver texto
                const nameFilter = (this.searchModeValue === 'name' && this.searchInput.value.trim()) 
                    ? this.searchInput.value.trim().toLowerCase() 
                    : '';
                
                this.currentFilters = {
                    name_search: nameFilter,
                    min_rating: this.minRating.value ? parseFloat(this.minRating.value) : null,
                    sort_by: this.priceSort.value,
                    services: this.getSelectedServices(),
                    max_distance: parseFloat(this.maxDistance.value)
                };

                // Aplicar filtros aos dados atuais
                this.applyFiltersToCurrentData();
            }

            getSelectedServices() {
                const checkboxes = this.servicesFilter.querySelectorAll('input[type="checkbox"]:checked');
                return Array.from(checkboxes).map(cb => cb.value);
            }

            clearAllFilters() {
                // N√£o limpar o campo de busca principal, apenas os filtros avan√ßados
                this.minRating.value = '';
                this.priceSort.value = '';
                this.maxDistance.value = '5';
                this.distanceValue.textContent = '5 km';

                // Limpar checkboxes de servi√ßos
                const checkboxes = this.servicesFilter.querySelectorAll('input[type="checkbox"]');
                checkboxes.forEach(cb => {
                    cb.checked = false;
                    cb.closest('.service-checkbox').classList.remove('checked');
                });

                this.currentFilters = {};
                this.applyFiltersToCurrentData();
            }

            // M√©todo para aplicar filtros aos dados atuais
            applyFiltersToCurrentData() {
                console.log('[DEBUG] applyFiltersToCurrentData chamado. allBarbearias:', this.allBarbearias.length);
                if (this.allBarbearias.length === 0) {
                    console.log('[DEBUG] Nenhuma barbearia para filtrar');
                    return;
                }

                let filteredBarbearias = [...this.allBarbearias];
                console.log('[DEBUG] Barbearias antes dos filtros:', filteredBarbearias.length);

                // Filtro por avalia√ß√£o m√≠nima
                if (this.currentFilters.min_rating) {
                    filteredBarbearias = filteredBarbearias.filter(barbearia => 
                        barbearia.rating >= this.currentFilters.min_rating
                    );
                    console.log('[DEBUG] Ap√≥s filtro de rating:', filteredBarbearias.length);
                }

                // Filtro por servi√ßos
                if (this.currentFilters.services && this.currentFilters.services.length > 0) {
                    filteredBarbearias = filteredBarbearias.filter(barbearia => {
                        return this.currentFilters.services.some(service => 
                            barbearia.services.some(barbeariaService => 
                                barbeariaService.toLowerCase().includes(service.toLowerCase())
                            )
                        );
                    });
                    console.log('[DEBUG] Ap√≥s filtro de servi√ßos:', filteredBarbearias.length);
                }

                // Filtro por dist√¢ncia - S√ì aplicar se estiver no modo LOCALIZA√á√ÉO e tiver coordenadas
                // No modo NOME, as barbearias podem n√£o ter dist√¢ncia definida
                if (this.currentFilters.max_distance && this.searchModeValue === 'location' && this.currentLocation) {
                    filteredBarbearias = filteredBarbearias.filter(barbearia => 
                        barbearia.distance != null && barbearia.distance <= this.currentFilters.max_distance
                    );
                    console.log('[DEBUG] Ap√≥s filtro de dist√¢ncia:', filteredBarbearias.length);
                } else {
                    console.log('[DEBUG] Filtro de dist√¢ncia ignorado (modo:', this.searchModeValue, ', tem location:', !!this.currentLocation, ')');
                }

                // Ordena√ß√£o por pre√ßo
                if (this.currentFilters.sort_by) {
                    filteredBarbearias = this.sortBarbeariasByPrice(filteredBarbearias, this.currentFilters.sort_by);
                }

                this.displayBarbearias(filteredBarbearias);
                
                // Mostrar contador de resultados
                this.showResultsCount(filteredBarbearias.length, this.allBarbearias.length);
                
                // Mostrar indicador de ordena√ß√£o se ativo
                this.showSortIndicator();
            }

            // M√©todo para mostrar indicador de ordena√ß√£o
            showSortIndicator() {
                // Remover indicador anterior se existir
                const existingIndicator = document.querySelector('.sort-indicator');
                if (existingIndicator) {
                    existingIndicator.remove();
                }

                if (this.currentFilters.sort_by) {
                    const sortTexts = {
                        'cheap': 'üí∞ Ordenado por: Mais barato primeiro',
                        'expensive': 'üíé Ordenado por: Mais caro primeiro',
                        'rating': '‚≠ê Ordenado por: Melhor avalia√ß√£o',
                        'distance': 'üìç Ordenado por: Mais pr√≥ximo'
                    };

                    const indicatorDiv = document.createElement('div');
                    indicatorDiv.className = 'sort-indicator';
                    indicatorDiv.style.cssText = `
                        text-align: center;
                        margin: 8px 0;
                        padding: 8px 12px;
                        background: rgba(16, 185, 129, 0.1);
                        border: 1px solid rgba(16, 185, 129, 0.3);
                        border-radius: 6px;
                        color: #6ee7b7;
                        font-size: 0.85rem;
                        font-weight: 500;
                    `;
                    indicatorDiv.textContent = sortTexts[this.currentFilters.sort_by];
                    
                    // Inserir antes da lista de barbearias
                    this.barbeariasList.parentNode.insertBefore(indicatorDiv, this.barbeariasList);
                }
            }

            // M√©todo para ordenar barbearias
            sortBarbeariasByPrice(barbearias, sortType) {
                return barbearias.sort((a, b) => {
                    switch (sortType) {
                        case 'cheap':
                            return a.price_level - b.price_level; // Mais barato primeiro
                        case 'expensive':
                            return b.price_level - a.price_level; // Mais caro primeiro
                        case 'rating':
                            return b.rating - a.rating; // Melhor avalia√ß√£o primeiro
                        case 'distance':
                            // A dist√¢ncia agora √© um n√∫mero, a convers√£o n√£o √© mais necess√°ria.
                            return (a.distance || 999) - (b.distance || 999); // Mais pr√≥ximo primeiro
                        default:
                            return 0;
                    }
                });
            }

            // M√©todo para mostrar contador de resultados
            showResultsCount(filteredCount, totalCount) {
                // Remover contador anterior se existir
                const existingCounter = document.querySelector('.results-counter');
                if (existingCounter) {
                    existingCounter.remove();
                }

                if (filteredCount !== totalCount) {
                    const counterDiv = document.createElement('div');
                    counterDiv.className = 'results-counter';
                    counterDiv.style.cssText = `
                        text-align: center;
                        margin: 16px 0;
                        padding: 12px;
                        background: rgba(59, 130, 246, 0.1);
                        border: 1px solid rgba(59, 130, 246, 0.3);
                        border-radius: 8px;
                        color: #60a5fa;
                        font-size: 0.9rem;
                        font-weight: 500;
                    `;
                    counterDiv.textContent = `Mostrando ${filteredCount} de ${totalCount} barbearias`;
                    
                    // Inserir antes da lista de barbearias
                    this.barbeariasList.parentNode.insertBefore(counterDiv, this.barbeariasList);
                }
            }

            getMockBarbearias() {
                return [
                    {
                        id: 1,
                        name: 'Barber King',
                        image: 'https://via.placeholder.com/50x50/3b82f6/ffffff?text=BK',
                        services: ['Design de sobrancelhas', 'Barboterapia', 'Pigmenta√ß√£o', 'Relaxamento', 'Progressivas', 'Limpeza de pele', 'Massagem facial', 'Toalha quente'],
                        hours: '08:00 √†s 18:00',
                        distance: '0.8 km',
                        rating: 4.8,
                        price_level: 3,
                        opening_hours: {
                            "monday": {"open": "08:00", "close": "18:00"},
                            "tuesday": {"open": "08:00", "close": "18:00"},
                            "wednesday": {"open": "08:00", "close": "18:00"},
                            "thursday": {"open": "08:00", "close": "18:00"},
                            "friday": {"open": "08:00", "close": "19:00"},
                            "saturday": {"open": "08:00", "close": "17:00"},
                            "sunday": {"open": "09:00", "close": "15:00"}
                        }
                    },
                    {
                        id: 2,
                        name: 'Barbearia do Jo√£o',
                        image: 'https://via.placeholder.com/50x50/10b981/ffffff?text=BJ',
                        services: ['Corte masculino', 'Barba', 'Sobrancelha', 'Relaxamento'],
                        hours: '09:00 √†s 19:00',
                        distance: '1.2 km',
                        rating: 4.6,
                        price_level: 2,
                        opening_hours: {
                            "monday": {"open": "09:00", "close": "19:00"},
                            "tuesday": {"open": "09:00", "close": "19:00"},
                            "wednesday": {"open": "09:00", "close": "19:00"},
                            "thursday": {"open": "09:00", "close": "19:00"},
                            "friday": {"open": "09:00", "close": "20:00"},
                            "saturday": {"open": "08:00", "close": "18:00"},
                            "sunday": {"closed": true}
                        }
                    },
                    {
                        id: 3,
                        name: 'Studio Hair',
                        image: 'https://via.placeholder.com/50x50/8b5cf6/ffffff?text=SH',
                        services: ['Corte', 'Barba', 'Design de sobrancelhas', 'Massagem', 'Tratamentos'],
                        hours: '08:30 √†s 17:30',
                        distance: '2.1 km',
                        rating: 4.9,
                        price_level: 4,
                        opening_hours: {
                            "monday": {"open": "08:30", "close": "17:30"},
                            "tuesday": {"open": "08:30", "close": "17:30"},
                            "wednesday": {"open": "08:30", "close": "17:30"},
                            "thursday": {"open": "08:30", "close": "17:30"},
                            "friday": {"open": "08:30", "close": "18:30"},
                            "saturday": {"open": "08:00", "close": "16:00"},
                            "sunday": {"closed": true}
                        }
                    },
                    {
                        id: 4,
                        name: 'Barbearia Central',
                        image: 'https://via.placeholder.com/50x50/f59e0b/ffffff?text=BC',
                        services: ['Corte masculino', 'Barba', 'Sobrancelha', 'Relaxamento', 'Progressivas'],
                        hours: '07:00 √†s 20:00',
                        distance: '3.5 km',
                        rating: 4.4,
                        price_level: 2,
                        opening_hours: {
                            "monday": {"open": "07:00", "close": "20:00"},
                            "tuesday": {"open": "07:00", "close": "20:00"},
                            "wednesday": {"open": "07:00", "close": "20:00"},
                            "thursday": {"open": "07:00", "close": "20:00"},
                            "friday": {"open": "07:00", "close": "21:00"},
                            "saturday": {"open": "07:00", "close": "19:00"},
                            "sunday": {"open": "08:00", "close": "16:00"}
                        }
                    },
                    {
                        id: 5,
                        name: 'Elite Barber',
                        image: 'https://via.placeholder.com/50x50/ef4444/ffffff?text=EB',
                        services: ['Corte masculino', 'Barba', 'Design de sobrancelhas', 'Massagem facial', 'Tratamentos capilares'],
                        hours: '09:00 √†s 18:00',
                        distance: '4.2 km',
                        rating: 4.7,
                        price_level: 3,
                        opening_hours: {
                            "monday": {"open": "09:00", "close": "18:00"},
                            "tuesday": {"open": "09:00", "close": "18:00"},
                            "wednesday": {"open": "09:00", "close": "18:00"},
                            "thursday": {"open": "09:00", "close": "18:00"},
                            "friday": {"open": "09:00", "close": "19:00"},
                            "saturday": {"open": "08:00", "close": "17:00"},
                            "sunday": {"closed": true}
                        }
                    },
                    {
                        id: 6,
                        name: 'Barbearia Popular',
                        image: 'https://via.placeholder.com/50x50/22c55e/ffffff?text=BP',
                        services: ['Corte masculino', 'Barba', 'Sobrancelha'],
                        hours: '08:00 √†s 19:00',
                        distance: '1.8 km',
                        rating: 4.2,
                        price_level: 1,
                        opening_hours: {
                            "monday": {"open": "08:00", "close": "19:00"},
                            "tuesday": {"open": "08:00", "close": "19:00"},
                            "wednesday": {"open": "08:00", "close": "19:00"},
                            "thursday": {"open": "08:00", "close": "19:00"},
                            "friday": {"open": "08:00", "close": "20:00"},
                            "saturday": {"open": "08:00", "close": "18:00"},
                            "sunday": {"open": "09:00", "close": "16:00"}
                        }
                    }
                ];
            }

            displayBarbearias(barbearias) {
                console.log('[DEBUG] displayBarbearias chamado com', barbearias?.length, 'barbearias');
                // Armazenar todas as barbearias para filtragem
                this.allBarbearias = barbearias;

                if (!barbearias || barbearias.length === 0) {
                    console.log('[DEBUG] Nenhuma barbearia para exibir');
                    this.barbeariasList.innerHTML = `<div class="info-text" style="text-align:center; padding: 40px;">Nenhuma barbearia encontrada com os crit√©rios selecionados. Tente aumentar o raio da busca.</div>`;
                    this.showResultsCount(0, 0);
                    return;
                }
                
                console.log('[DEBUG] Gerando HTML para', barbearias.length, 'barbearias');
                
                this.barbeariasList.innerHTML = barbearias.map(barbearia => {
                    // Lida com a imagem (API envia 'photos', mock usava 'image')
                    const imageUrl = barbearia.photos && barbearia.photos.length > 0 && barbearia.photos[0]
                        ? barbearia.photos[0]
                        : `https://ui-avatars.com/api/?name=${encodeURIComponent(barbearia.name)}&background=3b82f6&color=fff&size=50`;

                    // Formata a dist√¢ncia (API envia n√∫mero, n√£o texto)
                    const distanceText = barbearia.distance != null ? `${barbearia.distance.toFixed(1)} km` : '';

                    // Formata a avalia√ß√£o
                    const ratingText = barbearia.rating ? `‚≠ê ${barbearia.rating.toFixed(1)}` : '';

                    // Constr√≥i a linha de metadados
                    const metaParts = [ratingText, distanceText, this.getPriceLevelText(barbearia.price_level)].filter(Boolean);
                    const metaText = metaParts.join(' ‚Ä¢ ');

                    return `
                        <div class="barbearia-card" onclick="barbeariasFinder.selectBarbearia(${barbearia.id})">
                            <div class="barbearia-header">
                                <img src="${imageUrl}" alt="${barbearia.name}" class="barbearia-image">
                                <div class="barbearia-info">
                                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                                        <h3 style="margin: 0;">${barbearia.name}</h3>
                                        ${this.getStatusIndicator(barbearia.opening_hours)}
                                    </div>
                                    <div class="barbearia-meta">
                                        ${metaText}
                                    </div>
                                </div>
                                <div class="barbearia-hours">${barbearia.hours || ''}</div>
                            </div>
                            <div class="services-list">
                                ${(barbearia.services || []).map(service => `<span class="service-tag">${service}</span>`).join('')}
                            </div>
                        </div>`;
                }).join('');
                
                // Mostrar contador de resultados
                this.showResultsCount(barbearias.length, barbearias.length);
            }

            // M√©todo para converter n√≠vel de pre√ßo em texto
            getPriceLevelText(priceLevel) {
                const priceLevels = {
                    1: '$ - Econ√¥mico',
                    2: '$$ - Moderado', 
                    3: '$$$ - Caro',
                    4: '$$$$ - Premium'
                };
                return priceLevels[priceLevel] || '$$ - Moderado';
            }
            
            getStatusIndicator(openingHours) {
                const now = new Date();
                const currentDay = now.toLocaleDateString('pt-BR', { weekday: 'long' }).toLowerCase();
                const currentTime = now.toTimeString().slice(0, 5); // HH:MM
                
                // Mapear dias da semana
                const dayMap = {
                    'domingo': 'sunday',
                    'segunda-feira': 'monday',
                    'ter√ßa-feira': 'tuesday',
                    'quarta-feira': 'wednesday',
                    'quinta-feira': 'thursday',
                    'sexta-feira': 'friday',
                    's√°bado': 'saturday'
                };
                
                const dayKey = dayMap[currentDay];
                const todaySchedule = openingHours[dayKey];
                
                if (!todaySchedule || todaySchedule.closed) {
                    return `
                        <div class="status-indicator closed">
                            <div class="status-dot closed"></div>
                            Fechado
                        </div>
                    `;
                }
                
                const isOpen = this.isTimeInRange(currentTime, todaySchedule.open, todaySchedule.close);
                
                if (isOpen) {
                    return `
                        <div class="status-indicator open">
                            <div class="status-dot open"></div>
                            Aberto
                        </div>
                    `;
                } else {
                    return `
                        <div class="status-indicator closed">
                            <div class="status-dot closed"></div>
                            Fechado
                        </div>
                    `;
                }
            }
            
            isTimeInRange(currentTime, openTime, closeTime) {
                const current = this.timeToMinutes(currentTime);
                const open = this.timeToMinutes(openTime);
                const close = this.timeToMinutes(closeTime);
                
                return current >= open && current <= close;
            }
            
            timeToMinutes(timeString) {
                const [hours, minutes] = timeString.split(':').map(Number);
                return hours * 60 + minutes;
            }

            selectBarbearia(barbeariaId) {
                console.log('Barbearia selecionada:', barbeariaId);
                // Navegar para p√°gina de detalhes da barbearia
                window.location.href = `BarbeariaDetalhes.html?id=${barbeariaId}`;
            }

            showLoading() {
                this.barbeariasList.innerHTML = `
                    <div class="loading">
                        <div class="loading-spinner"></div>
                        <div>Carregando barbearias pr√≥ximas...</div>
                    </div>
                `;
            }

            showError(message) {
                this.barbeariasList.innerHTML = `
                    <div class="error-message">${message}</div>
                `;
            }

            showSuccess(message) {
                const successDiv = document.createElement('div');
                successDiv.className = 'success-message';
                successDiv.textContent = message;
                
                // Inserir ap√≥s o campo de busca
                const formGroup = this.searchInput.closest('.form-group');
                formGroup.insertAdjacentElement('afterend', successDiv);
                
                setTimeout(() => {
                    successDiv.remove();
                }, 3000);
            }
        }

        // Fun√ß√£o global para o bot√£o voltar
        function handleBackButton() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
            
            if (currentUser.email) {
                // Usu√°rio logado, voltar para dashboard apropriado
                const userType = currentUser.tipo || 'cliente';
                if (userType === 'barbearia') {
                    window.location.href = 'BarbeariaDashboard.html';
                } else {
                    window.location.href = 'ClienteDashboard.html';
                }
            } else {
                // Usu√°rio n√£o logado, voltar para tela inicial
                window.location.href = 'Login.html';
            }
        }

        // Fun√ß√£o global para o bot√£o voltar
        function handleBackButton() {
            console.log('handleBackButton chamada - voltando para p√°gina anterior');
            
            // Usar history.back() para voltar para a p√°gina anterior
            if (window.history.length > 1) {
                window.history.back();
            } else {
                // Se n√£o h√° hist√≥rico, redirecionar baseado no tipo de usu√°rio
                console.log('Sem hist√≥rico, redirecionando baseado no tipo de usu√°rio');
                
                try {
                    const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
                    const userType = localStorage.getItem('userType');
                    
                    const detectedUserType = currentUser.tipo || userType || 'cliente';
                    
                    if (detectedUserType === 'barbearia') {
                        window.location.href = 'BarbeariaDashboard.html';
                    } else {
                        window.location.href = 'ClienteDashboard.html';
                    }
                } catch (error) {
                    console.error('Erro no fallback:', error);
                    window.location.href = 'Login.html';
                }
            }
        }

        // Inicializar quando a p√°gina carregar
        let barbeariasFinder;
        document.addEventListener('DOMContentLoaded', () => {
            barbeariasFinder = new BarbeariasFinder();
        });
    </script>
</body>
</html>
